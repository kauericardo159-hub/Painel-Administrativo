-- Nome do Script: ESPInjetor
local RunService = game:GetService("RunService")
local player = game.Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")
local MainGui = pGui:WaitForChild("MainControlPanel")
local Scroll = MainGui.MainFrame.ButtonList

local espActive = false

local function applyESP(char, color, label)
    if not char:FindFirstChild("Highlight") then
        local h = Instance.new("Highlight", char)
        h.FillColor = color
        h.OutlineColor = Color3.new(1,1,1)
        
        local bgui = Instance.new("BillboardGui", char)
        bgui.Name = "ESP_UI"
        bgui.AlwaysOnTop = true
        bgui.Size = UDim2.new(0, 100, 0, 50)
        bgui.Adornee = char:FindFirstChild("Head")
        
        local txt = Instance.new("TextLabel", bgui)
        txt.Size = UDim2.new(1, 0, 1, 0)
        txt.BackgroundTransparency = 1
        txt.TextColor3 = color
        txt.TextStrokeTransparency = 0
        txt.Font = Enum.Font.GothamBold
        txt.TextSize = 12
        txt.Text = label
    end
end

local function clearESP()
    for _, v in pairs(workspace:GetDescendants()) do
        if v.Name == "Highlight" or v.Name == "ESP_UI" then v:Destroy() end
    end
end

local function updateLoop()
    if not espActive then return end
    for _, model in pairs(workspace:GetChildren()) do
        local hum = model:FindFirstChild("Humanoid")
        if hum and model ~= player.Character then
            local p = game.Players:GetPlayerFromCharacter(model)
            if p then
                applyESP(model, p.TeamColor.Color, p.Name)
            else
                applyESP(model, Color3.new(1, 0, 0), "[BOT] " .. model.Name)
            end
        end
    end
end

local EspBtn = Instance.new("TextButton")
EspBtn.Parent = Scroll
EspBtn.Size = UDim2.new(1, 0, 0, 40)
EspBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
EspBtn.Text = "3 | ATIVAR/DESATIVAR VIEW"
EspBtn.TextColor3 = Color3.new(1,1,1)
EspBtn.Font = Enum.Font.GothamBold
Instance.new("UICorner", EspBtn)

EspBtn.MouseButton1Click:Connect(function()
    espActive = not espActive
    if espActive then
        EspBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
    else
        EspBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        clearESP()
    end
end)

RunService.RenderStepped:Connect(updateLoop)
