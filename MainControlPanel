-- Nome do Script: MainControlPanel_V2
local TweenService = game:GetService("TweenService")
local player = game.Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")

-- Destruir versão antiga se existir para não duplicar
if pGui:FindFirstChild("MainControlPanel") then
    pGui.MainControlPanel:Destroy()
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "MainControlPanel"
ScreenGui.Parent = pGui
ScreenGui.ResetOnSpawn = false

-- Frame Principal (Deitado/Horizontal)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
MainFrame.Position = UDim2.new(0.5, -250, 0.5, -125) -- Centralizado
MainFrame.Size = UDim2.new(0, 500, 0, 300) -- Formato deitado
MainFrame.BorderSizePixel = 0
MainFrame.Visible = false
MainFrame.ClipsDescendants = true

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 15)
MainCorner.Parent = MainFrame

-- Barra de Título (Header)
local Header = Instance.new("Frame")
Header.Name = "Header"
Header.Parent = MainFrame
Header.Size = UDim2.new(1, 0, 0, 45)
Header.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Header.BorderSizePixel = 0

local HeaderCorner = Instance.new("UICorner")
HeaderCorner.CornerRadius = UDim.new(0, 15)
HeaderCorner.Parent = Header

-- Título (Nome)
local Title = Instance.new("TextLabel")
Title.Parent = Header
Title.Size = UDim2.new(1, 0, 1, 0)
Title.BackgroundTransparency = 1
Title.Text = "MEU PAINEL DE CONTROLE" -- Você pode mudar o nome aqui
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20

-- Container da Lista de Botões (Rolagem)
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Name = "ButtonList"
ScrollFrame.Parent = MainFrame
ScrollFrame.Position = UDim2.new(0, 10, 0, 55)
ScrollFrame.Size = UDim2.new(1, -20, 1, -65)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.BorderSizePixel = 0
ScrollFrame.ScrollBarThickness = 4
ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 80)
ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0) -- Ajusta automaticamente

-- Layout da Lista (Grid para botões lado a lado ou List para um abaixo do outro)
local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Parent = ScrollFrame
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0, 10)

-- Ajuste automático do tamanho do Scroll
UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y + 20)
end)

-- --- FUNÇÃO DE ANIMAÇÃO ---
local function toggleMenu(visible)
    if visible then
        MainFrame.Visible = true
        MainFrame.Size = UDim2.new(0, 0, 0, 300) -- Começa fino
        TweenService:Create(MainFrame, TweenInfo.new(0.6, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
            Size = UDim2.new(0, 500, 0, 300)
        }):Play()
    else
        local tween = TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.In), {
            Size = UDim2.new(0, 0, 0, 300)
        })
        tween:Play()
        tween.Completed:Connect(function()
            if MainFrame.Size.X.Offset < 10 then
                MainFrame.Visible = false
            end
        end)
    end
end

-- Detectar quando o botão de abrir for clicado no outro script
-- Nota: Isso assume que o botão de abrir altera a visibilidade do MainFrame
MainFrame:GetPropertyChangedSignal("Visible"):Connect(function()
    toggleMenu(MainFrame.Visible)
end)
