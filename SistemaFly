-- Nome do Script: FlyMobile_Elite
local player = game.Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")
local RunService = game:GetService("RunService")

-- Espera o Painel Principal
local ScreenGui = pGui:WaitForChild("MainControlPanel", 10)
local Scroll = ScreenGui.MainFrame:WaitForChild("ButtonList")

-- Variáveis de Controle
local flying = false
local flySpeed = 50
local bv, bg

-- --- INTERFACE DO BOTÃO ---
local Container = Instance.new("Frame")
Container.Name = "FlyContainer"
Container.Parent = Scroll
Container.Size = UDim2.new(1, -10, 0, 50)
Container.BackgroundTransparency = 1

local UIList = Instance.new("UIListLayout", Container)
UIList.FillDirection = Enum.FillDirection.Horizontal
UIList.Padding = UDim.new(0, 10)
UIList.VerticalAlignment = Enum.VerticalAlignment.Center

-- Input de Velocidade
local SpeedInput = Instance.new("TextBox")
SpeedInput.Name = "SpeedInput"
SpeedInput.Parent = Container
SpeedInput.Size = UDim2.new(0, 120, 0, 40)
SpeedInput.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
SpeedInput.Text = "Vel: 50"
SpeedInput.PlaceholderText = "Vel..."
SpeedInput.TextColor3 = Color3.new(1, 1, 1)
SpeedInput.Font = Enum.Font.GothamBold
SpeedInput.TextSize = 14

local UICornerInput = Instance.new("UICorner", SpeedInput)
UICornerInput.CornerRadius = UDim.new(0, 8)

-- Botão de Ativar/Desativar
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Name = "ToggleBtn"
ToggleBtn.Parent = Container
ToggleBtn.Size = UDim2.new(1, -130, 0, 40)
ToggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
ToggleBtn.Text = "FLY: INATIVO"
ToggleBtn.TextColor3 = Color3.new(1, 1, 1)
ToggleBtn.Font = Enum.Font.GothamBold
ToggleBtn.TextSize = 14

local UICornerBtn = Instance.new("UICorner", ToggleBtn)
UICornerBtn.CornerRadius = UDim.new(0, 8)

-- --- LÓGICA DO FLY ---

-- Atualizar Velocidade pelo Input
SpeedInput.FocusLost:Connect(function()
    local val = tonumber(SpeedInput.Text:match("%d+"))
    if val then
        flySpeed = val
        SpeedInput.Text = "Vel: " .. val
    else
        SpeedInput.Text = "Vel: " .. flySpeed
    end
end)

local function startFly()
    local char = player.Character or player.CharacterAdded:Wait()
    local root = char:WaitForChild("HumanoidRootPart")
    local hum = char:WaitForChild("Humanoid")
    
    bg = Instance.new("BodyGyro", root)
    bg.P = 9e4
    bg.maxTorque = Vector3.new(9e4, 9e4, 9e4)
    bg.cframe = root.CFrame
    
    bv = Instance.new("BodyVelocity", root)
    bv.velocity = Vector3.new(0, 0, 0)
    bv.maxForce = Vector3.new(9e4, 9e4, 9e4)
    
    hum.PlatformStand = true
    
    task.spawn(function()
        while flying do
            -- A mágica do Mobile: Pegar a direção que o Humanoid quer andar (Analógico)
            local moveDir = hum.MoveDirection
            
            if moveDir.Magnitude > 0 then
                bv.velocity = moveDir * flySpeed
            else
                bv.velocity = Vector3.new(0, 0, 0)
            end
            
            -- Mantém o corpo virado para onde a câmera aponta
            bg.cframe = workspace.CurrentCamera.CFrame
            RunService.RenderStepped:Wait()
        end
    end)
end

ToggleBtn.MouseButton1Click:Connect(function()
    flying = not flying
    if flying then
        ToggleBtn.Text = "FLY: ATIVO"
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
        startFly()
    else
        ToggleBtn.Text = "FLY: INATIVO"
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        if bg then bg:Destroy() end
        if bv then bv:Destroy() end
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.PlatformStand = false
        end
    end
end)
